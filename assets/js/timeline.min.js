(()=>{"use strict";class t{constructor(t,e){this.timeline=e,this.info=t.innerHTML,this.startYear=parseFloat(t.dataset.start),this.endYear=parseFloat(t.dataset.end),this.color=`#${t.dataset.color}`,this.xCoord=null}drawEventLine(){const t=this.timeline.canvas.context,e=this.timeline.style.eventWidth,s=this.timeline.yearsYCoords;t.beginPath(),t.lineWidth=e,t.strokeStyle=this.color,t.lineCap="round",t.moveTo(this.xCoord,s[this.startYear]+e/2),t.moveTo(this.xCoord,s[this.endYear]-e/2),t.stroke()}drawInfo(){}formatInfoLayout(t,e){}}class e{constructor(t){this.timelineElement=t,this.currentWidth=t.offsetWidth,this.currentHeight=t.offsetHeight,this.startYear=parseInt(t.dataset.start,10),this.endYear=parseInt(t.dataset.end,10),this.initCanvas(t),this.getStyles(),this.parseEvents(),this.precomputeStaticValues(),this.computeBaseLayout(),this.computeEventLayout(),this.drawBase(),this.events.forEach((t=>t.draw()))}precomputeStaticValues(){const t=this.canvas.context;t.font=`${this.style.yearFontsize} sans-serif`;const e=t.measureText("00000");this.yearXOffset=e.width,this.yearLineHeight=e.actualBoundingBoxAscent,t.font=`${this.style.infoFontsize} sans-serif`,this.infoLineHeight=t.measureText("0").actualBoundingBoxAscent}computeBaseLayout(){const t=this.style.verticalPadding,e=(this.canvas.element.height-this.style.verticalPadding-t)/(4*(this.endYear-this.startYear)),s={},i={};for(let n=this.startYear,r=t;n<=this.endYear;n+=.25,r+=e)s[n]=Math.floor(r),i[n]=Array(this.events.length).fill(0);this.yearsYCoords=s,this.occupedGrid=i,this.centerXCoord=Math.round(this.canvas.element.width/2-this.yearXOffset)}computeEventLayout(){const t=[this.centerXCoord];let e=1;for(;t.length<this.events.length;){const s=e*(this.style.eventWidth+this.style.eventOffset);t.push(this.centerXCoord+s),t.length<this.events.length&&t.push(this.centerXCoord-s),e++}const s=[];this.events.forEach((e=>{const i=this.occupedGrid[e.startYear].indexOf(0),n=t[i];e.xCoord=n,s.push(n);for(let t=e.startYear;t<e.endYear;t+=.25)this.occupedGrid[t][i]=1})),this.infoLeftXCoord=Math.min(s)-this.style.infoXOffset,this.infoRightXCoord=Math.max(s)+this.style.infoXOffset}drawBase(){const t=this.canvas.context;t.beginPath(),t.fillStyle=this.style.yearColor,t.textAlign="right",t.font=`${this.style.year_fontsize} sans-serif`,t.strokeStyle=this.style.gridlineColor,t.lineWidth=this.style.gridlineWidth;for(const[e,s]of Object.entries(this.yearsYCoords))Number.isInteger(Number(e))&&(t.fillText(e,this.canvas.element.width,s+this.yearLineHeight/2),t.moveTo(0,s),t.lineTo(this.canvas.element.width-this.yearXOffset,s));t.stroke()}getStyles(){const t=getComputedStyle(this.timelineElement),e=t.getPropertyValue("--background-color").trim(),i=parseFloat(t.getPropertyValue("--background-alpha")),n=t.getPropertyValue("--year-color").trim(),r=parseFloat(t.getPropertyValue("--year-alpha")),a=t.getPropertyValue("--gridline-color").trim(),o=parseFloat(t.getPropertyValue("--gridline-alpha")),h=t.getPropertyValue("--info-font-color").trim(),l=parseInt(t.getPropertyValue("--info-font-alpha"),10);this.style={verticalPadding:parseInt(t.getPropertyValue("--vertical-padding"),10),yearFontsize:t.getPropertyValue("--year-font-size").trim(),gridlineWidth:parseInt(t.getPropertyValue("--gridline-width"),10),eventWidth:parseInt(t.getPropertyValue("--event-width"),10),eventOffset:parseInt(t.getPropertyValue("--event-offset"),10),infoLineWidth:parseInt(t.getPropertyValue("--info-line-width"),10),infoXOffset:parseInt(t.getPropertyValue("--info-x-offset"),10),infoYOffset:parseFloat(t.getPropertyValue("--info-y-offset")),infoFontsize:t.getPropertyValue("--info-font-size").trim(),backgroundColor:s(e,i),yearColor:s(n,r),gridlineColor:s(a,o),infoFontColor:s(h,l)}}initCanvas(t){const e=document.createElement("canvas");e.className="timeline-canvas-el",e.width=t.clientWidth,e.height=t.clientHeight,t.appendChild(e),this.canvas={element:e,context:e.getContext("2d")}}onResize(){const t=this.timelineElement.clientWidth,e=this.timelineElement.clientHeight;t===this.currentWidth&&e===this.currentHeight||(this.canvas.context.clearRect(0,0,this.currentWidth,this.currentHeight),this.canvas.element.width=t,this.canvas.element.height=e,this.currentWidth=t,this.currentHeight=e,this.computeBaseLayout(),this.computeEventLayout(),this.drawBase(),this.events.forEach((t=>t.draw())))}parseEvents(){const e=this.timelineElement.getElementsByTagName("li"),s=[];Array.prototype.forEach.call(e,(e=>{s.push(new t(e,this))})),this.events=s}}const s=(t,e=1)=>{const s=t.replace("#","");return`rgba(${parseInt(s.substring(0,2),16)},${parseInt(s.substring(2,4),16)},${parseInt(s.substring(4,6),16)},${e})`},i=document.getElementById(tagID);if(null!==i){const t=new e(i);i.addEventListener("resize",t.onResize)}})();