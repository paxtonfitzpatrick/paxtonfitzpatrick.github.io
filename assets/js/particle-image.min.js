"use strict";function ParticleImageDisplayer(e,t){this.pImageConfig={particles:{array:[],density:100,color:"#fff",size:{value:2,random:!1},movement:{speed:1,restless:{enabled:!1,value:10}},interactivity:{on_hover:{enabled:!0,action:"repulse"},on_click:{enabled:!1,action:"big_repulse"},on_touch:{enabled:!0,action:"repulse"},fn_array:[]}},image:{src:{path:null,is_external:!1},size:{canvas_pct:60,min_px:50,max_px:800},bottom_constraint:{el:document.getElementById("header-content")}},interactions:{repulse:{distance:100,strength:200},big_repulse:{distance:100,strength:500},grab:{distance:100,line_width:1}},canvas:{el:e,w:e.offsetWidth,h:e.offsetHeight,offset_top:72},functions:{particles:{},image:{},canvas:{},interactivity:{},utils:{}},mouse:{x:null,y:null,click_x:null,click_y:null}};const n=this.pImageConfig;t&&Object.deepExtend(n,t),n.functions.canvas.init=function(){n.canvas.context=n.canvas.el.getContext("2d"),n.canvas.el.width=n.canvas.w,n.canvas.el.height=n.canvas.h,n.image.height_available=n.image.bottom_constraint.el.offsetTop-n.canvas.offset_top,n.canvas.aspect_ratio=n.canvas.w/n.image.height_available,window.addEventListener("resize",n.functions.utils.debounce(n.functions.canvas.onResize,200),n.eventListenerOpts)},n.functions.canvas.onResize=function(){n.canvas.w=n.canvas.el.offsetWidth,n.canvas.h=n.canvas.el.offsetHeight,n.canvas.el.width=n.canvas.w,n.canvas.el.height=n.canvas.h,n.image.height_available=n.image.bottom_constraint.el.offsetTop-n.canvas.offset_top,n.canvas.aspect_ratio=n.canvas.w/n.image.height_available,n.particles.array=[],n.functions.image.resize();const e=n.functions.canvas.getImagePixels();n.functions.particles.createImageParticles(e,!0)},n.functions.canvas.clear=function(){n.canvas.context.clearRect(0,0,n.canvas.w,n.canvas.h)},n.functions.canvas.getImagePixels=function(){n.functions.canvas.clear(),n.canvas.context.drawImage(n.image.obj,n.image.x,n.image.y,n.image.obj.width,n.image.obj.height);const e=n.canvas.context.getImageData(n.image.x,n.image.y,n.image.obj.width,n.image.obj.height);return n.functions.canvas.clear(),e},n.functions.image.resize=function(){n.image.aspect_ratio<n.canvas.aspect_ratio?(n.image.obj.height=n.functions.utils.clamp(Math.round(n.image.height_available*n.image.size.canvas_pct/100),n.image.size.min_px,n.image.size.max_px),n.image.obj.width=Math.round(n.image.obj.height*n.image.aspect_ratio)):(n.image.obj.width=n.functions.utils.clamp(Math.round(n.canvas.w*n.image.size.canvas_pct/100),n.image.size.min_px,n.image.size.max_px),n.image.obj.height=Math.round(n.image.obj.width/n.image.aspect_ratio)),n.image.x=n.canvas.w/2-n.image.obj.width/2,n.image.y=n.image.height_available/2-n.image.obj.height/2},n.functions.image.init=function(){n.image.obj=new Image,n.image.obj.addEventListener("load",(()=>{n.image.aspect_ratio=n.image.obj.width/n.image.obj.height,n.functions.image.resize();const e=n.functions.canvas.getImagePixels();n.functions.particles.createImageParticles(e),n.functions.particles.animateParticles()}),n.eventListenerOpts);let e=n.image.src.path;n.image.src.is_external&&(e=`https://cors-anywhere.herokuapp.com/${n.image.src.path}`,n.image.obj.crossOrigin="anonymous"),n.image.obj.src=e},n.functions.particles.SingleImageParticle=function(e,t){this.x=e.x,this.y=e.y,this.dest_x=t.x,this.dest_y=t.y,this.vx=(Math.random()-.5)*n.particles.movement.speed,this.vy=(Math.random()-.5)*n.particles.movement.speed,this.acc_x=0,this.acc_y=0,this.friction=.01*Math.random()+.92,this.restlessness={max_displacement:Math.ceil(Math.random()*n.particles.movement.restless.value),x_jitter:n.functions.utils.randIntInRange(-3,3),y_jitter:n.functions.utils.randIntInRange(-3,3),on_curr_frame:!1},n.particles.color instanceof Array?this.color=n.particles.color[Math.floor(Math.random()*(n.particles.color.length+1))]:this.color=n.particles.color,this.radius=Math.round((n.particles.size.random?Math.max(Math.random(),.5):1)*n.particles.size.value)},n.functions.particles.SingleImageParticle.prototype.draw=function(){n.canvas.context.fillStyle=this.color,n.canvas.context.beginPath(),n.canvas.context.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),n.canvas.context.fill()},n.functions.particles.createImageParticles=function(e,t=!1){const a=Math.round(e.width/n.particles.density);for(let i=0;i<e.width;i+=a)for(let s=0;s<e.height;s+=a)if(e.data[4*(i+s*e.width)+3]>128){const e={x:n.image.x+i,y:n.image.y+s},a=t?e:{x:Math.random()*n.canvas.w,y:Math.random()*n.canvas.h};n.particles.array.push(new n.functions.particles.SingleImageParticle(a,e))}},n.functions.particles.updateParticles=function(){for(const e of n.particles.array)n.particles.movement.restless.enabled&&e.restlessness.on_curr_frame?n.functions.particles.jitterParticle(e):(e.acc_x=(e.dest_x-e.x)/500,e.acc_y=(e.dest_y-e.y)/500,e.vx=(e.vx+e.acc_x)*e.friction,e.vy=(e.vy+e.acc_y)*e.friction,e.x+=e.vx,e.y+=e.vy),n.functions.interactivity.interactWithClient(e)},n.functions.particles.jitterParticle=function(e){e.x+=e.restlessness.x_jitter,e.y+=e.restlessness.y_jitter,Math.sqrt((e.dest_x-e.x)**2+(e.dest_y-e.y)**2)>=n.particles.movement.restless.value&&(e.restlessness.on_curr_frame=!1)},n.functions.particles.animateParticles=function(){n.functions.canvas.clear(),n.functions.particles.updateParticles();for(const e of n.particles.array)e.draw();window.requestAnimationFrame(n.functions.particles.animateParticles)},n.functions.interactivity.repulseParticle=function(e,t){const a=e.x-n.mouse.x,i=e.y-n.mouse.y,s=Math.sqrt(a*a+i*i),c=n.functions.utils.clamp(300-t.strength,10,300);s<=t.distance&&(e.acc_x=(e.x-n.mouse.x)/c,e.acc_y=(e.y-n.mouse.y)/c,e.vx+=e.acc_x,e.vy+=e.acc_y)},n.functions.interactivity.grabParticle=function(e,t){const a=e.x-n.mouse.x,i=e.y-n.mouse.y;Math.sqrt(a*a+i*i)<=t.distance&&(n.canvas.context.strokeStyle=e.color,n.canvas.context.lineWidth=Math.min(t.line_width,2*e.radius),n.canvas.context.beginPath(),n.canvas.context.moveTo(e.x,e.y),n.canvas.context.lineTo(n.mouse.x,n.mouse.y),n.canvas.context.stroke(),n.canvas.context.closePath())},n.functions.interactivity.onMouseMove=function(e,t,a){null!=n.mouse.x&&null!=n.mouse.y&&e(a,t)},n.functions.interactivity.onMouseClick=function(e,t,a){null!=n.mouse.click_x&&null!=n.mouse.click_y&&e(a,t)},n.functions.interactivity.addEventListeners=function(){(n.particles.interactivity.on_hover.enabled||n.particles.interactivity.on_click.enabled)&&(n.canvas.el.addEventListener("mousemove",(e=>{const t=e.offsetX||e.clientX,a=e.offsetY||e.clientY;n.mouse.x=t,n.mouse.y=a}),n.eventListenerOpts),n.canvas.el.addEventListener("mouseleave",(()=>{n.mouse.x=null,n.mouse.y=null}),n.eventListenerOpts),n.functions.utils.addEventActions("on_hover")),n.particles.interactivity.on_click.enabled&&(n.canvas.el.addEventListener("mousedown",(()=>{n.mouse.click_x=n.mouse.x,n.mouse.click_y=n.mouse.y}),n.eventListenerOpts),n.canvas.el.addEventListener("mouseup",(()=>{n.mouse.click_x=null,n.mouse.click_y=null}),n.eventListenerOpts),n.functions.utils.addEventActions("on_click")),n.particles.interactivity.on_touch.enabled&&(n.canvas.el.addEventListener("touchmove",(e=>{const t=e.touches[0].clientX,a=e.touches[0].clientY;n.mouse.x=t,n.mouse.y=a}),n.eventListenerOpts),n.canvas.el.addEventListener("touchend",(()=>{n.mouse.x=null,n.mouse.y=null}),n.eventListenerOpts),n.functions.utils.addEventActions("on_touch"))},n.functions.interactivity.interactWithClient=function(e){for(const t of n.particles.interactivity.fn_array)t(e)},n.functions.utils.randIntInRange=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},n.functions.utils.clamp=function(e,t,n){return Math.min(Math.max(e,t),n)},n.functions.utils.debounce=function(e,t){let n;return a=>{n&&clearTimeout(n),n=setTimeout(e,t,a)}},n.functions.utils.addEventActions=function(e){const t={repulse:n.functions.interactivity.repulseParticle,big_repulse:n.functions.interactivity.repulseParticle,grab:n.functions.interactivity.grabParticle},a="on_click"===e?n.functions.interactivity.onMouseClick:n.functions.interactivity.onMouseMove;if(n.particles.interactivity[e].enabled){const i=t[n.particles.interactivity[e].action],s=n.interactions[n.particles.interactivity[e].action],c=a.bind(null,i,s);n.particles.interactivity.fn_array.push(c)}},n.functions.launch=function(){n.functions.interactivity.addEventListeners(),n.functions.canvas.init(),n.functions.image.init()},n.disabled||n.functions.launch()}Object.deepExtend=function e(t,n){for(const a in n)n[a]&&n[a].constructor&&n[a].constructor===Object?(t[a]=t[a]||{},e(t[a],n[a])):t[a]=n[a];return t},window.pImgDom=[],window.particleImageDisplay=function(e){let t=!1;try{const e=Object.defineProperty({},"passive",{get:()=>{t={passive:!0}}});window.addEventListener("checkPEL",null,e),window.removeEventListener("checkPEL",null,e)}catch{}const n=document.getElementById(e),a="particle-image-canvas-el",i=n.getElementsByClassName(a);if(i.length)for(;i.length>0;)n.removeChild(i[0]);const s=document.createElement("canvas");s.className=a,s.style.width="100%",s.style.height="calc(100% - 72px)";const c=document.getElementById(e).appendChild(s);if(null!=c){const e=n.dataset.paramsSrc,a=new XMLHttpRequest;a.overrideMimeType("application/json"),a.open("GET",e,!1),a.onreadystatechange=()=>{if(4===a.readyState&&200===a.status){const e=JSON.parse(a.responseText);e.eventListenerOpts=t,window.pImgDom.push(new ParticleImageDisplayer(c,e))}else console.log(`failed to load params.json. XMLHTTPRequest status: ${a.statusText}`)},a.send()}},window.particleImageDisplay("particle-image");
//# sourceMappingURL=particle-image.min.js.map